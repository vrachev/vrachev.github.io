---
import { getCollection } from 'astro:content';

// Fetch all posts from the 'thisweek' collection
const thisWeekPosts = await getCollection('thisweek');

// Sort posts by startDate in descending order to get the latest post first
const sortedPosts = thisWeekPosts.sort((a, b) => {
  return new Date(b.data.startDate).getTime() - new Date(a.data.startDate).getTime();
});

// Get the URL of the latest post
const latestPostUrl = sortedPosts.length > 0 ? `/thisweek/${sortedPosts[0].slug}` : '/';

// Redirect to it
return Astro.redirect(latestPostUrl);
---
